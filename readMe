Comparative Analysis of Short-Read RNA Sequencing Tools Using Minimap2 as Ground Truth

Project Overview

The goal of this project is to compare the accuracy of STAR, HISAT2, and Minimap2 short read RNA-seq alignment. This includes evaluating the accuracy of splice junctions and approximate coordinates aligned in tools by comparing subreads extracted from long-read sequencing data against expected results derived long read Minimap2 alignment. The project is intended to help identify the strengths and weaknesses of various RNA sequencing tools when applied to different datasets.

Current State of the Project

This repository currently contains two Python scripts that perform specific tasks related to the project's goal:

1. *Subread Extraction Script (`querytable.py`):
    - Purpose: Extracts random subreads from long-read sequencing BAM files, allowing for the generation of smaller read sequences that can be compared against short-read RNA sequencing tools.
    - Functionality: 
      - Parses CIGAR strings from BAM files to identify and handle clipped reads.
      - Outputs extracted subreads in FASTA format, which can be used for alignment and comparison with short-read tools.
    - Current Status: Fully implemented and functional. This script can be used to generate test data for short-read RNA sequencing tool evaluation.

2. CIGAR String Comparison Script (`cigarcomparison.py`):
    - Purpose: Compares the CIGAR strings of subreads against expected CIGAR strings derived from their corresponding long reads. This allows for the assessment of how well the subreads align back to the original full-length sequences.
    - Functionality: 
      - Aligns subreads to long reads and compares their CIGAR strings to calculate alignment accuracy and precision.
      - Outputs the comparison results in a TSV format for further analysis.
      - Prints out a summarized version of the information.
    - Current Status: Fully implemented and functional. This script can be used to evaluate the accuracy of short-read RNA sequencing tools by comparing their outputs against the expected results.

Project Goals and Next Steps

The overall aim is to extend this foundational work to compare different RNA sequencing tools using the subreads extracted by the `subread_extraction.py` script and to evaluate their performance using the `cigar_comparison.py` script. The following tasks are recommended for anyone who wishes to continue the project:

1. Tool Integration and Comparison:
    - Objective: Integrate different short-read RNA sequencing tools (e.g., STAR, HISAT2, etc.) into the workflow.
    - Steps:
        - Align the subreads generated by `querytable.py` using these tools.
        - Compare the alignment results with the expected CIGAR strings using `cigarcomparison.py`.
        - Analyze and summarize the performance of each tool under various scenarios.

2. Scenario Testing:
    - Objective: Test the RNA sequencing tools across different conditions and datasets (e.g., varying levels of noise, different species, etc.).
    - Steps:
        - Prepare different datasets or introduce variations in the current dataset.
        - Run the alignment tools and analyze the results using the comparison script.
        - Document the findings and compare the performance of the tools across scenarios.

3. Documentation and Reporting:
    - Objective: Enhance the project documentation with detailed reports on tool performance and recommendations.
    - Steps:
        - Summarize the findings from the tool comparisons and scenario testing.
        - Create detailed documentation or reports that explain the results, strengths, and weaknesses of each tool.

Contributing

If you're interested in contributing to this project, please follow these steps:

1. Fork the repository and create a new branch for your feature or fix.
2. Implement your changes and thoroughly test the functionality.
3. Submit a pull request with a clear description of your changes and their purpose.

Contact - For any questions or more information about the project, please contact:

Alvin Zhang - alvinttzhang7@gmail.com / atzhang@mxschool.edu / 508-810-8860 

Acknowledgments

Professor Heng Li (http://liheng.org/) for advising me on this project throughout the summer and giving me this incredible opportunity to work in his lab.
Huang Neng (https://github.com/huangnengCSU) as my mentor for this project.
Ying Zhou for his assistance with sequence ID troubles.
Rest of the Li Lab (https://hlilab.github.io/) 

Special thanks to the developers of the `pysam` and `tabulate` libraries, which are essential tools for handling BAM files and generating readable output tables, respectively.
